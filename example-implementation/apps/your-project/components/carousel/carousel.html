<div data-sly-use.carousel="com.adobe.cq.wcm.core.components.models.Carousel"
     data-sly-use.template="core/wcm/components/commons/v1/templates.html"
     class="cmp-carousel custom-carousel-3cards"
     data-cmp-is="carousel"
     data-cmp-autoplay="${carousel.autoplay ? 'true' : 'false'}"
     data-cmp-delay="${carousel.delay}"
     data-cmp-autopauseDisabled="${carousel.autopauseDisabled ? 'true' : 'false'}"
     id="${carousel.id}">

    <!-- Show actual carousel in preview mode -->
    <div data-sly-test="${!wcmmode.edit && carousel.items.size > 0}" 
         class="cmp-carousel__content">
        <div class="cmp-carousel__container">
            <div class="cmp-carousel__track">
                <div data-sly-repeat.item="${carousel.items}" 
                     class="cmp-carousel__item ${item.active ? 'cmp-carousel__item--active' : ''}"
                     data-cmp-hook-carousel="item">
                    <sly data-sly-resource="${item.path @ resourceType=item.resourceType}"></sly>
                </div>
            </div>
        </div>
        
        <!-- Navigation -->
        <div class="cmp-carousel__actions">
            <button class="cmp-carousel__action cmp-carousel__action--previous" 
                    aria-label="Previous"
                    data-cmp-hook-carousel="previous">
                <span class="cmp-carousel__action-icon">‹</span>
            </button>
            <button class="cmp-carousel__action cmp-carousel__action--next" 
                    aria-label="Next"
                    data-cmp-hook-carousel="next">
                <span class="cmp-carousel__action-icon">›</span>
            </button>
        </div>
        
        <!-- Indicators -->
        <div class="cmp-carousel__indicators" data-sly-test="${carousel.items.size > 1}">
            <button data-sly-repeat.item="${carousel.items}"
                    class="cmp-carousel__indicator ${item.active ? 'cmp-carousel__indicator--active' : ''}"
                    data-cmp-hook-carousel="indicator"
                    data-cmp-carousel-item="${itemList.index}">
            </button>
        </div>
    </div>

    <!-- CRITICAL: Container for authoring mode - this enables dropping components -->
    <div data-sly-test="${wcmmode.edit}"
         class="carousel-authoring-container">
        <sly data-sly-resource="${resource @ resourceType='wcm/foundation/components/parsys'}"></sly>
    </div>
</div>

<!-- Show placeholder when no content and in edit mode -->
<sly data-sly-test="${wcmmode.edit && carousel.items.size == 0}" 
     data-sly-call="${template.placeholder @ isEmpty=true, classAppend='cmp-carousel'}"></sly>